<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN" "http://www.springframework.org/dtd/spring-beans-2.0.dtd">
<beans default-lazy-init="false" default-autowire="byName">

    <bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>classpath*:conf/jmx.properties</value>
            </list>
        </property>
    </bean>

    <bean id="registry" class="org.springframework.remoting.rmi.RmiRegistryFactoryBean" lazy-init="false">
        <property name="port" value="${jmx.rmi_port}" />
    </bean>

    <bean id="serverConnector" class="org.springframework.jmx.support.ConnectorServerFactoryBean" lazy-init="false">
        <property name="serviceUrl" value="service:jmx:rmi:///jndi/rmi://${server.host}:${jmx.rmi_port}/jmx" />
        <property name="environment">
            <map>
                <!-- 认证配置,使用绝对路径 -->
                <!--
                    <entry key="jmx.remote.x.password.file" value="/mypath/jmxremote.password" /> <entry
                    key="jmx.remote.x.access.file" value="/mypath/jmxremote.access" />
                -->
            </map>
        </property>
    </bean>

    <bean id="exporter" class="org.springframework.jmx.export.MBeanExporter" lazy-init="false">
        <property name="beans">
            <map>
                <entry key="com.family168:type=User" value-ref="userMBean" />
            </map>
        </property>
    </bean>

    <bean id="userMBean" class="com.family168.UserMBeanImpl"/>

    <bean id="clientConnector" class="org.springframework.jmx.support.MBeanServerConnectionFactoryBean">
        <property name="serviceUrl" value="service:jmx:rmi:///jndi/rmi://${server.host}:${jmx.rmi_port}/jmx"/>
    </bean>

</beans>
